DEBUG 2026-02-07 14:59:57,123 celery.utils.functional 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

DEBUG 2026-02-07 14:59:57,124 celery.utils.functional 
def xmap(task, it):
    return 1

DEBUG 2026-02-07 14:59:57,124 celery.utils.functional 
def backend_cleanup():
    return 1

DEBUG 2026-02-07 14:59:57,124 celery.utils.functional 
def process_sheet_upload(self, file_id, user_id, model=0, user_provided_description=1):
    return 1

DEBUG 2026-02-07 14:59:57,124 celery.utils.functional 
def chain(*args, **kwargs):
    return 1

DEBUG 2026-02-07 14:59:57,124 celery.utils.functional 
def xstarmap(task, it):
    return 1

DEBUG 2026-02-07 14:59:57,124 celery.utils.functional 
def accumulate(self, *args, **kwargs):
    return 1

DEBUG 2026-02-07 14:59:57,124 celery.utils.functional 
def debug_task(self):
    return 1

DEBUG 2026-02-07 14:59:57,124 celery.utils.functional 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

DEBUG 2026-02-07 14:59:57,124 celery.utils.functional 
def chunks(task, it, n):
    return 1

DEBUG 2026-02-07 14:59:57,125 celery.utils.functional 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

Creating test database for alias 'default'...
.......................INFO 2026-02-07 14:59:57,780 modules.transactions.use_cases.tools.get_actors GetActorsToolUseCase.execute due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:57,782 modules.transactions.use_cases.tools.get_actors GetActorsToolUseCase.execute due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:57,783 modules.transactions.use_cases.tools.get_actors GetActorsToolUseCase.execute due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:57,784 modules.transactions.use_cases.tools.get_actors GetActorsToolUseCase.execute due_date_start='2026-03-01', due_date_end='2026-03-31'
....INFO 2026-02-07 14:59:57,799 modules.transactions.use_cases.tools.get_transactions GetTransactionsToolUseCase.execute transaction_type=None, due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:57,800 modules.transactions.use_cases.tools.get_transactions GetTransactionsToolUseCase.execute transaction_type='incoming', due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:57,801 modules.transactions.use_cases.tools.get_transactions GetTransactionsToolUseCase.execute transaction_type='outgoing', due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:57,803 modules.transactions.use_cases.tools.get_transactions GetTransactionsToolUseCase.execute transaction_type='outgoing', due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:57,804 modules.transactions.use_cases.tools.get_transactions GetTransactionsToolUseCase.execute transaction_type=None, due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:57,810 modules.transactions.use_cases.tools.get_user_general_stats GetUserGeneralStatsToolUseCase.execute due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:57,811 modules.transactions.use_cases.tools.get_user_general_stats GetUserGeneralStatsToolUseCase.execute due_date_start='2026-01-01', due_date_end='2026-12-31'
.INFO 2026-02-07 14:59:57,812 modules.transactions.use_cases.tools.get_user_general_stats GetUserGeneralStatsToolUseCase.execute due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:57,813 modules.transactions.use_cases.tools.get_user_general_stats GetUserGeneralStatsToolUseCase.execute due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:57,814 modules.transactions.use_cases.tools.get_user_general_stats GetUserGeneralStatsToolUseCase.execute due_date_start='2026-03-01', due_date_end='2026-03-31'
............................INFO 2026-02-07 14:59:58,074 modules.transactions.use_cases.tools.get_actor_detail GetActorDetailToolUseCase.execute actor_id='1', due_date_start='2026-04-01', due_date_end='2026-04-30'
.INFO 2026-02-07 14:59:58,206 modules.transactions.use_cases.tools.get_actor_detail GetActorDetailToolUseCase.execute actor_id='2', due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:58,351 modules.transactions.use_cases.tools.get_actors GetActorsToolUseCase.execute due_date_start='2026-04-01', due_date_end='2026-04-30'
.INFO 2026-02-07 14:59:58,486 modules.transactions.use_cases.tools.get_actors GetActorsToolUseCase.execute due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:58,633 modules.transactions.use_cases.tools.get_sub_transactions_from_transaction GetSubTransactionsFromTransactionToolUseCase.execute transaction_id=7
.INFO 2026-02-07 14:59:58,778 modules.transactions.use_cases.tools.get_transactions GetTransactionsToolUseCase.execute transaction_type=None, due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:58,910 modules.transactions.use_cases.tools.get_transactions GetTransactionsToolUseCase.execute transaction_type='incoming', due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:59,040 modules.transactions.use_cases.tools.get_transactions GetTransactionsToolUseCase.execute transaction_type='outgoing', due_date_start='2026-03-01', due_date_end='2026-03-31'
.INFO 2026-02-07 14:59:59,169 modules.transactions.use_cases.tools.get_transactions GetTransactionsToolUseCase.execute transaction_type=None, due_date_start='2026-04-01', due_date_end='2026-04-30'
.INFO 2026-02-07 14:59:59,315 modules.transactions.use_cases.tools.get_user_general_stats GetUserGeneralStatsToolUseCase.execute due_date_start='2026-03-01', due_date_end='2026-03-31'
................INFO 2026-02-07 14:59:59,336 modules.ai.use_cases.ask [AskUseCase.ask_ai] Calling LLM service...
ERROR 2026-02-07 14:59:59,336 modules.ai.use_cases.ask [AskUseCase.ask_ai] LLMGatewayException: API Error
.INFO 2026-02-07 14:59:59,336 modules.ai.use_cases.ask [AskUseCase.ask_ai] Calling LLM service...
INFO 2026-02-07 14:59:59,336 modules.ai.use_cases.ask [AskUseCase.ask_ai] LLM service returned successfully
.INFO 2026-02-07 14:59:59,336 modules.ai.use_cases.ask [AskUseCase] Starting execute with model: test-model, user_id: 1
INFO 2026-02-07 14:59:59,336 modules.ai.use_cases.ask [AskUseCase] Prompt length: 1 parts, response_format: None
INFO 2026-02-07 14:59:59,336 modules.ai.use_cases.ask [AskUseCase] AI request built, calling LLM...
INFO 2026-02-07 14:59:59,336 modules.ai.use_cases.ask [AskUseCase.ask_ai] Calling LLM service...
INFO 2026-02-07 14:59:59,336 modules.ai.use_cases.ask [AskUseCase.ask_ai] LLM service returned successfully
INFO 2026-02-07 14:59:59,336 modules.ai.use_cases.ask [AskUseCase] LLM response received, saving to repository...
INFO 2026-02-07 14:59:59,336 modules.ai.use_cases.ask [AskUseCase] Response saved with id: response_123
.INFO 2026-02-07 14:59:59,337 modules.ai.use_cases.ask [AskUseCase] Starting execute with model: test-model, user_id: 1
INFO 2026-02-07 14:59:59,337 modules.ai.use_cases.ask [AskUseCase] Prompt length: 1 parts, response_format: json_object
INFO 2026-02-07 14:59:59,337 modules.ai.use_cases.ask [AskUseCase] AI request built, calling LLM...
INFO 2026-02-07 14:59:59,337 modules.ai.use_cases.ask [AskUseCase.ask_ai] Calling LLM service...
INFO 2026-02-07 14:59:59,337 modules.ai.use_cases.ask [AskUseCase.ask_ai] LLM service returned successfully
INFO 2026-02-07 14:59:59,337 modules.ai.use_cases.ask [AskUseCase] LLM response received, saving to repository...
INFO 2026-02-07 14:59:59,337 modules.ai.use_cases.ask [AskUseCase] Response saved with id: response_123
................................E.E.....INFO 2026-02-07 14:59:59,349 modules.file_reader.use_cases.upload_sheet [UploadSheet] Starting upload for user 1, file: test.xlsx, model: deepseek-chat
INFO 2026-02-07 14:59:59,349 modules.file_reader.use_cases.upload_sheet [UploadSheet] File saved with id: 123
INFO 2026-02-07 14:59:59,349 modules.file_reader.use_cases.upload_sheet [UploadSheet] Queuing processing task for file: 123
INFO 2026-02-07 14:59:59,349 modules.file_reader.use_cases.upload_sheet [UploadSheet] Task queued successfully
.INFO 2026-02-07 14:59:59,350 modules.file_reader.use_cases.upload_sheet [UploadSheet] Starting upload for user 1, file: test.xlsx, model: deepseek-chat
INFO 2026-02-07 14:59:59,350 modules.file_reader.use_cases.upload_sheet [UploadSheet] File saved with id: 123
INFO 2026-02-07 14:59:59,350 modules.file_reader.use_cases.upload_sheet [UploadSheet] Queuing processing task for file: 123
INFO 2026-02-07 14:59:59,350 modules.file_reader.use_cases.upload_sheet [UploadSheet] Task queued successfully
.INFO 2026-02-07 14:59:59,350 modules.file_reader.use_cases.upload_sheet [UploadSheet] Starting upload for user 1, file: test.xlsx, model: deepseek-chat
INFO 2026-02-07 14:59:59,350 modules.file_reader.use_cases.upload_sheet [UploadSheet] File saved with id: 123
INFO 2026-02-07 14:59:59,350 modules.file_reader.use_cases.upload_sheet [UploadSheet] Queuing processing task for file: 123
INFO 2026-02-07 14:59:59,350 modules.file_reader.use_cases.upload_sheet [UploadSheet] Task queued successfully
.INFO 2026-02-07 14:59:59,350 modules.file_reader.use_cases.upload_sheet [UploadSheet] Starting upload for user 1, file: test.xlsx, model: custom-model
INFO 2026-02-07 14:59:59,350 modules.file_reader.use_cases.upload_sheet [UploadSheet] File saved with id: 123
INFO 2026-02-07 14:59:59,350 modules.file_reader.use_cases.upload_sheet [UploadSheet] Queuing processing task for file: 123
INFO 2026-02-07 14:59:59,351 modules.file_reader.use_cases.upload_sheet [UploadSheet] Task queued successfully
.INFO 2026-02-07 14:59:59,351 modules.file_reader.use_cases.upload_sheet [UploadSheet] Starting upload for user 1, file: test.xlsx, model: deepseek-chat
INFO 2026-02-07 14:59:59,351 modules.file_reader.use_cases.upload_sheet [UploadSheet] File saved with id: 123
INFO 2026-02-07 14:59:59,351 modules.file_reader.use_cases.upload_sheet [UploadSheet] Queuing processing task for file: 123
INFO 2026-02-07 14:59:59,351 modules.file_reader.use_cases.upload_sheet [UploadSheet] Task queued successfully
.INFO 2026-02-07 14:59:59,351 modules.transactions.use_cases.tools.get_actor_detail GetActorDetailToolUseCase.execute actor_id='1', due_date_start='2026-01-01', due_date_end='2026-01-31'
.INFO 2026-02-07 14:59:59,351 modules.transactions.use_cases.tools.get_actor_detail GetActorDetailToolUseCase.execute actor_id='1', due_date_start='2026-01-01', due_date_end='2026-01-31'
.INFO 2026-02-07 14:59:59,351 modules.transactions.use_cases.tools.get_actor_stats GetActorStatsToolUseCase.execute due_date_start='2026-01-01', due_date_end='2026-01-31'
.INFO 2026-02-07 14:59:59,352 modules.transactions.use_cases.tools.get_actor_stats GetActorStatsToolUseCase.execute due_date_start='2026-01-01', due_date_end='2026-01-31'
.INFO 2026-02-07 14:59:59,352 modules.transactions.use_cases.tools.get_actors GetActorsToolUseCase.execute due_date_start='2026-01-01', due_date_end='2026-01-31'
.INFO 2026-02-07 14:59:59,352 modules.transactions.use_cases.tools.get_actors GetActorsToolUseCase.execute due_date_start='2026-01-01', due_date_end='2026-01-31'
.INFO 2026-02-07 14:59:59,352 modules.transactions.use_cases.tools.get_sub_transactions_from_transaction GetSubTransactionsFromTransactionToolUseCase.execute transaction_id=1
.INFO 2026-02-07 14:59:59,352 modules.transactions.use_cases.tools.get_sub_transactions_from_transaction GetSubTransactionsFromTransactionToolUseCase.execute transaction_id=1
.INFO 2026-02-07 14:59:59,352 modules.transactions.use_cases.tools.get_transactions GetTransactionsToolUseCase.execute transaction_type=None, due_date_start='2026-01-01', due_date_end='2026-01-31'
.INFO 2026-02-07 14:59:59,352 modules.transactions.use_cases.tools.get_transactions GetTransactionsToolUseCase.execute transaction_type=None, due_date_start='2026-01-01', due_date_end='2026-01-31'
.INFO 2026-02-07 14:59:59,352 modules.transactions.use_cases.tools.get_transactions GetTransactionsToolUseCase.execute transaction_type=None, due_date_start='2026-01-01', due_date_end='2026-01-31'
.INFO 2026-02-07 14:59:59,352 modules.transactions.use_cases.tools.get_user_general_stats GetUserGeneralStatsToolUseCase.execute due_date_start='2026-01-01', due_date_end='2026-01-31'
.INFO 2026-02-07 14:59:59,353 modules.transactions.use_cases.tools.get_user_general_stats GetUserGeneralStatsToolUseCase.execute due_date_start='2026-01-01', due_date_end='2026-01-31'
.INFO 2026-02-07 14:59:59,353 modules.transactions.use_cases.tools.get_user_general_stats GetUserGeneralStatsToolUseCase.execute due_date_start='2026-01-01', due_date_end='2026-01-31'
.
======================================================================
ERROR: test_execute_copies_all_pages (modules.file_reader.tests.test_remove_pdf_password_use_case.TestRemovePDFPasswordUseCase.test_execute_copies_all_pages)
Test that execute copies all pages from the original PDF.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/josepedrodasilvagomes/.pyenv/versions/3.12.8/lib/python3.12/unittest/mock.py", line 1396, in patched
    return func(*newargs, **newkeywargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/josepedrodasilvagomes/Projects/personal/bills-manager/backend/modules/file_reader/tests/test_remove_pdf_password_use_case.py", line 137, in test_execute_copies_all_pages
    with patch('modules.file_reader.use_cases.remover_pdf_password.BytesIO', return_value=mock_output):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/josepedrodasilvagomes/.pyenv/versions/3.12.8/lib/python3.12/unittest/mock.py", line 1467, in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
  File "/Users/josepedrodasilvagomes/.pyenv/versions/3.12.8/lib/python3.12/unittest/mock.py", line 1437, in get_original
    raise AttributeError(
AttributeError: <module 'modules.file_reader.use_cases.remover_pdf_password' from '/Users/josepedrodasilvagomes/Projects/personal/bills-manager/backend/modules/file_reader/use_cases/remover_pdf_password.py'> does not have the attribute 'BytesIO'

======================================================================
ERROR: test_execute_removes_password_from_encrypted_pdf (modules.file_reader.tests.test_remove_pdf_password_use_case.TestRemovePDFPasswordUseCase.test_execute_removes_password_from_encrypted_pdf)
Test that execute removes password from an encrypted PDF.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/josepedrodasilvagomes/.pyenv/versions/3.12.8/lib/python3.12/unittest/mock.py", line 1396, in patched
    return func(*newargs, **newkeywargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/josepedrodasilvagomes/Projects/personal/bills-manager/backend/modules/file_reader/tests/test_remove_pdf_password_use_case.py", line 50, in test_execute_removes_password_from_encrypted_pdf
    with patch('modules.file_reader.use_cases.remover_pdf_password.BytesIO', return_value=mock_output):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/josepedrodasilvagomes/.pyenv/versions/3.12.8/lib/python3.12/unittest/mock.py", line 1467, in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
  File "/Users/josepedrodasilvagomes/.pyenv/versions/3.12.8/lib/python3.12/unittest/mock.py", line 1437, in get_original
    raise AttributeError(
AttributeError: <module 'modules.file_reader.use_cases.remover_pdf_password' from '/Users/josepedrodasilvagomes/Projects/personal/bills-manager/backend/modules/file_reader/use_cases/remover_pdf_password.py'> does not have the attribute 'BytesIO'

----------------------------------------------------------------------
Ran 154 tests in 1.653s

FAILED (errors=2)
Destroying test database for alias 'default'...
Found 154 test(s).
System check identified no issues (0 silenced).
